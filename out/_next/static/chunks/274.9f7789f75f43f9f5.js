"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[274],{4274:(t,e,s)=>{s.r(e),s.d(e,{default:()=>M});var i=s(7876),a=s(4232),l=s(8341),n=s(7579),c=s(211),r=s(851),o=s(6020),m=s(5099),u=s(1876),d=s(1629),p=s(5800);function x(t){return({tps:"TPS",msptMedian:"MSPT",cpuProcess:"CPU (process)",cpuSystem:"CPU (system)",players:"Players",entities:"Entities",tileEntities:"Tile Entities",chunks:"Chunks"})[t]}function y(t){return({tps:"#71E27D",msptMedian:"#E271D5",cpuProcess:"#719DE2",cpuSystem:"#F7AD48",players:"#b72c7d",entities:"#fc704f",tileEntities:"#addcff",chunks:"#d9dee3"})[t]}function f(t){let{scale:e,data:s,maxima:l,selectionCallback:d}=t,p=(0,a.useMemo)(()=>k(),[]),f=s.length/7*80,b=s.some(t=>t.statisticName.includes("cpu"))?150:100;return(0,i.jsxs)(n.t,{theme:p,width:800,height:170,padding:{top:10,left:60,right:60,bottom:30},domain:{x:[-e,0],y:[0,1]},containerComponent:(0,i.jsx)(h,{responsive:!0,brushDimension:"x",brushStyle:{stroke:"transparent",fill:"white",fillOpacity:.05},onBrushDomainChangeEnd:t=>{d(t.x)},mouseFollowTooltips:!0,voronoiDimension:"x",labelComponent:(0,i.jsx)(c.A,{flyoutStyle:{fill:"black",opacity:.6},flyoutWidth:b,flyoutHeight:f,flyoutPadding:0,centerOffset:{x:b/2,y:f/2},cornerRadius:3}),voronoiBlacklist:[/.*\-line$/],labels:t=>{var e,s;let{datum:i}=t;return"".concat(x(i.unit),": ").concat((e=i.y,["cpuProcess","cpuSystem"].includes(s=i.unit)?(100*e).toFixed(2)+"%":["msptMedian","tps"].includes(s)?e.toFixed(2):e.toFixed()))}}),children:[s.map((t,e)=>(0,i.jsx)(r.j,{name:"".concat(t.statisticName,"-line"),data:t.data,y:t=>t.y/l[e],style:{data:{stroke:y(t.statisticName)}}},e)),s.map((t,e)=>(0,i.jsx)(o.J,{name:"".concat(t.statisticName,"-scatter"),data:t.data,y:t=>t.y/l[e],size:t=>{let{datum:e,active:s}=t;return e.active||s?3:0},style:{data:{fill:y(t.statisticName),stroke:y(t.statisticName),strokeWidth:t=>3*!!t.active,strokeOpacity:.5},labels:{fill:y(t.statisticName),fontFamily:"JetBrains Mono",fontSize:10}}},e)),s.slice(-2).map((t,e)=>(0,i.jsx)(m.O,{orientation:0===e?"left":"right",invertAxis:0!==e,dependentAxis:!0,tickFormat:s=>(function(t,e,s){let i=t*l.slice(-2)[e];return["cpuProcess","cpuSystem"].includes(s.statisticName)?100*i+"%":i.toFixed()})(s,e,t),label:x(t.statisticName),axisLabelComponent:(0,i.jsx)(u.R,{dy:0===e?-35:35}),style:{axisLabel:{fill:y(t.statisticName)}}},e)),(0,i.jsx)(m.O,{domain:[0,-e],tickFormat:t=>"".concat(t,"m"),crossAxis:!1})]})}let h=(0,d.g)("brush","voronoi"),k=()=>{let t=p.g.material;return t.axis.style.grid.stroke="none",t.axis.style.tickLabels.fontFamily="JetBrains Mono",t.axis.style.axisLabel.fontFamily="JetBrains Mono",t.axis.style.axis.stroke="#888",t.axis.style.axisLabel.fill="#888",t.axis.style.tickLabels.fill="#888",t};var b=s(5039),N=s.n(b);function j(t){let{availableStatisticKeys:e,statisticKeys:s,setStatisticKeys:a}=t;return(0,i.jsx)("div",{className:"legend",children:e.map(t=>(0,i.jsx)("div",{className:N()("textbox","button",{toggled:s.includes(t)}),onClick:()=>{s.includes(t)?a(e=>e.filter(e=>e!==t)):a(e=>[...e,t])},style:{color:y(t)},children:x(t)},t))})}let v=["ticks","startTime","endTime","duration","msptMax"];function M(t){let{show:e,timeSelector:s,windowStatistics:n}=t,c=Array.from(s.times).sort(),r=n[c[0]],o=Object.keys(r).filter(t=>!!r[t]&&-1!=r[t]&&!v.includes(t)),[m,u]=(0,a.useState)(()=>{let t=o;return t.includes("msptMedian")?t.filter(t=>["msptMedian","tps"].includes(t)):t.includes("tps")?t.filter(t=>["cpuProcess","tps"].includes(t)):t.filter(t=>["cpuProcess","cpuSystem"].includes(t))}),d=Math.max(...c),p=m.map((t,e)=>({statisticName:t,data:c.map(i=>({i:e,unit:t,x:i-d,y:n[i][t],active:s.isTimeSelected(i)}))})),x=p.map(t=>{if(["cpuProcess","cpuSystem"].includes(t.statisticName))return 1;let e=Math.max(...t.data.map(t=>t.y));if("tps"===t.statisticName)return Math.max(e,20);if("msptMedian"===t.statisticName)return 10*Math.ceil(e/10);let s=e>1e3?1e3:e>100?100:10;return Math.ceil(e/s)*s}),y=c.length-1,{t:h}=(0,l.o)();return e?(0,i.jsxs)("div",{className:"graph",children:[(0,i.jsx)("h3",{children:h("viewer.sampler.refine.title")}),(0,i.jsx)("div",{className:"header-controls",children:(0,i.jsx)("p",{children:h("viewer.sampler.refine.description")})}),(0,i.jsx)(f,{scale:y,data:p,maxima:x,selectionCallback:t=>{s.setSelectedTimes(e=>{let s=e-d;return s>=t[0]&&s<=t[1]})}}),(0,i.jsx)(j,{availableStatisticKeys:o,statisticKeys:m,setStatisticKeys:u})]}):null}}}]);