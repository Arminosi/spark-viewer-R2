"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[274],{4274:(t,e,s)=>{s.r(e),s.d(e,{default:()=>j});var i=s(7876),a=s(4232),l=s(7579),n=s(211),c=s(851),r=s(6020),o=s(5099),u=s(1876),m=s(1629),d=s(5800);function p(t){return({tps:"TPS",msptMedian:"MSPT",cpuProcess:"CPU (process)",cpuSystem:"CPU (system)",players:"Players",entities:"Entities",tileEntities:"Tile Entities",chunks:"Chunks"})[t]}function f(t){return({tps:"#71E27D",msptMedian:"#E271D5",cpuProcess:"#719DE2",cpuSystem:"#F7AD48",players:"#b72c7d",entities:"#fc704f",tileEntities:"#addcff",chunks:"#d9dee3"})[t]}function y(t){let{scale:e,data:s,maxima:m,selectionCallback:d}=t,y=(0,a.useMemo)(()=>h(),[]),k=s.length/7*80,b=s.some(t=>t.statisticName.includes("cpu"))?150:100;return(0,i.jsxs)(l.t,{theme:y,width:800,height:170,padding:{top:10,left:60,right:60,bottom:30},domain:{x:[-e,0],y:[0,1]},containerComponent:(0,i.jsx)(x,{responsive:!0,brushDimension:"x",brushStyle:{stroke:"transparent",fill:"white",fillOpacity:.05},onBrushDomainChangeEnd:t=>{d(t.x)},mouseFollowTooltips:!0,voronoiDimension:"x",labelComponent:(0,i.jsx)(n.A,{flyoutStyle:{fill:"black",opacity:.6},flyoutWidth:b,flyoutHeight:k,flyoutPadding:0,centerOffset:{x:b/2,y:k/2},cornerRadius:3}),voronoiBlacklist:[/.*\-line$/],labels:t=>{var e,s;let{datum:i}=t;return"".concat(p(i.unit),": ").concat((e=i.y,["cpuProcess","cpuSystem"].includes(s=i.unit)?(100*e).toFixed(2)+"%":["msptMedian","tps"].includes(s)?e.toFixed(2):e.toFixed()))}}),children:[s.map((t,e)=>(0,i.jsx)(c.j,{name:"".concat(t.statisticName,"-line"),data:t.data,y:t=>t.y/m[e],style:{data:{stroke:f(t.statisticName)}}},e)),s.map((t,e)=>(0,i.jsx)(r.J,{name:"".concat(t.statisticName,"-scatter"),data:t.data,y:t=>t.y/m[e],size:t=>{let{datum:e,active:s}=t;return e.active||s?3:0},style:{data:{fill:f(t.statisticName),stroke:f(t.statisticName),strokeWidth:t=>3*!!t.active,strokeOpacity:.5},labels:{fill:f(t.statisticName),fontFamily:"JetBrains Mono",fontSize:10}}},e)),s.slice(-2).map((t,e)=>(0,i.jsx)(o.O,{orientation:0===e?"left":"right",invertAxis:0!==e,dependentAxis:!0,tickFormat:s=>(function(t,e,s){let i=t*m.slice(-2)[e];return["cpuProcess","cpuSystem"].includes(s.statisticName)?100*i+"%":i.toFixed()})(s,e,t),label:p(t.statisticName),axisLabelComponent:(0,i.jsx)(u.R,{dy:0===e?-35:35}),style:{axisLabel:{fill:f(t.statisticName)}}},e)),(0,i.jsx)(o.O,{domain:[0,-e],tickFormat:t=>"".concat(t,"m"),crossAxis:!1})]})}let x=(0,m.g)("brush","voronoi"),h=()=>{let t=d.g.material;return t.axis.style.grid.stroke="none",t.axis.style.tickLabels.fontFamily="JetBrains Mono",t.axis.style.axisLabel.fontFamily="JetBrains Mono",t.axis.style.axis.stroke="#888",t.axis.style.axisLabel.fill="#888",t.axis.style.tickLabels.fill="#888",t};var k=s(5039),b=s.n(k);function N(t){let{availableStatisticKeys:e,statisticKeys:s,setStatisticKeys:a}=t;return(0,i.jsx)("div",{className:"legend",children:e.map(t=>(0,i.jsx)("div",{className:b()("textbox","button",{toggled:s.includes(t)}),onClick:()=>{s.includes(t)?a(e=>e.filter(e=>e!==t)):a(e=>[...e,t])},style:{color:f(t)},children:p(t)},t))})}let g=["ticks","startTime","endTime","duration","msptMax"];function j(t){let{show:e,timeSelector:s,windowStatistics:l}=t,n=Array.from(s.times).sort(),c=l[n[0]],r=Object.keys(c).filter(t=>!!c[t]&&-1!=c[t]&&!g.includes(t)),[o,u]=(0,a.useState)(()=>{let t=r;return t.includes("msptMedian")?t.filter(t=>["msptMedian","tps"].includes(t)):t.includes("tps")?t.filter(t=>["cpuProcess","tps"].includes(t)):t.filter(t=>["cpuProcess","cpuSystem"].includes(t))});if(!e)return null;let m=Math.max(...n),d=o.map((t,e)=>({statisticName:t,data:n.map(i=>({i:e,unit:t,x:i-m,y:l[i][t],active:s.isTimeSelected(i)}))})),p=d.map(t=>{if(["cpuProcess","cpuSystem"].includes(t.statisticName))return 1;let e=Math.max(...t.data.map(t=>t.y));if("tps"===t.statisticName)return Math.max(e,20);if("msptMedian"===t.statisticName)return 10*Math.ceil(e/10);let s=e>1e3?1e3:e>100?100:10;return Math.ceil(e/s)*s}),f=n.length-1;return(0,i.jsxs)("div",{className:"graph",children:[(0,i.jsxs)("div",{className:"header",children:[(0,i.jsx)("h2",{children:"Refine"}),(0,i.jsx)("p",{children:"The graph below shows some key metrics over the course of the profile. You can drag + select with your cursor to refine the profile to a specific time period."})]}),(0,i.jsx)(y,{scale:f,data:d,maxima:p,selectionCallback:t=>{s.setSelectedTimes(e=>{let s=e-m;return s>=t[0]&&s<=t[1]})}}),(0,i.jsx)(N,{availableStatisticKeys:r,statisticKeys:o,setStatisticKeys:u})]})}}}]);